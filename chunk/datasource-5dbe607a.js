import{k as A,b as p,r as D,w as N,s as X,v as T,j as g,f as F}from"./xcs-vue-family-70642f71.js";import{t as B,R,b9 as M,ba as O,aq as U,ao as W,I as x,ar as C,b3 as y,b4 as _,v as j,y as q,u as H,bb as L,bc as $}from"../assets/index-83a10b2e.js";import{h as G,k as z}from"./xcs-canvas-5c2592d6.js";const[J,b]=B("notice-bar"),K={text:String,mode:String,color:String,delay:R(1),speed:R(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var Q=A({name:J,props:K,emits:["close","replay"],setup(e,{emit:i,slots:a}){let c=0,l=0,m;const v=p(),u=p(),n=D({show:!0,offset:0,duration:0}),I=()=>{if(a["left-icon"])return a["left-icon"]();if(e.leftIcon)return g(x,{class:b("left-icon"),name:e.leftIcon},null)},t=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},o=s=>{e.mode==="closeable"&&(n.show=!1,i("close",s))},r=()=>{if(a["right-icon"])return a["right-icon"]();const s=t();if(s)return g(x,{name:s,class:b("right-icon"),onClick:o},null)},w=()=>{n.offset=c,n.duration=0,_(()=>{y(()=>{n.offset=-l,n.duration=(l+c)/+e.speed,i("replay")})})},d=()=>{const s=e.scrollable===!1&&!e.wrapable,h={transform:n.offset?`translateX(${n.offset}px)`:"",transitionDuration:`${n.duration}s`};return g("div",{ref:v,role:"marquee",class:b("wrap")},[g("div",{ref:u,style:h,class:[b("content"),{"van-ellipsis":s}],onTransitionend:w},[a.default?a.default():e.text])])},f=()=>{const{delay:s,speed:h,scrollable:S}=e,k=j(s)?+s*1e3:0;c=0,l=0,n.offset=0,n.duration=0,clearTimeout(m),m=setTimeout(()=>{if(!v.value||!u.value||S===!1)return;const V=C(v).width,E=C(u).width;(S||E>V)&&y(()=>{c=V,l=E,n.offset=-l,n.duration=l/+h})},k)};return M(f),O(f),U("pageshow",f),W({reset:f}),N(()=>[e.text,e.scrollable],f),()=>{const{color:s,wrapable:h,background:S}=e;return X(g("div",{role:"alert",class:b({wrapable:h}),style:{color:s,background:S}},[I(),d(),r()]),[[T,n.show]])}}});const te=q(Q);const P=(e,i)=>{Object.assign(e,i),Object.keys(e).forEach(a=>{z(i).includes(a)||delete e[a]})},ae=()=>{const e=H(),i=p(""),a=F(()=>{var t;return i.value=((t=e.ext)==null?void 0:t.id)||"",L.dataSource}),c=D(a.value.getDeviceFormValues()),l=D(a.value.getProcessDataValues()),m=(t,o,r)=>{if(!r)return;const w=a.value.canvasManager.getCanvas(t).centralAxisPosition,{current:d}=r==null?void 0:r.getCurrentArea(o),s=G(d,"startX")?w!==0?w:d.startX:0;r.emit($.UPDATE_PROCESSING_AREA,{canvasId:t,option:{...d,startX:s!==0?s:d.startX}})},v=t=>{a.value.canvasId=t,u(),m(t,c.mode,e.ext)},u=()=>{var o,r;const t=a.value.getDeviceFormValues();(r=(o=e.ext)==null?void 0:o.handleDeviceFormValueChanged)==null||r.call(o,c,t),P(c,t)},n=()=>{const t=a.value.getProcessDataValues();P(l,t)};return{deviceValues:c,elementValues:l,updateCanvasId:v,updateSelectedElements:t=>{a.value.elements=t,n()},dataSource:a,deviceDataHandler(t,o){a.value.setDeviceFormValues(t,o),u(),t==="mode"&&m(a.value.canvasId,o.value,e.ext)},elementDataHandler(t,o){a.value.setProcessDataValues(t,o),n()}}};export{te as N,ae as u};
