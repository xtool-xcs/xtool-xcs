import{bc as $}from"../assets/index-83a10b2e.js";import"./setting.vue_vue_type_style_index_0_lang-315c55c2.js";import{_ as U}from"./setting.vue_vue_type_script_setup_true_lang-0ee96bfb.js";import{k as N,H as R,f as x,b as Y,w as T,D as X,I as j,a0 as q,a1 as H,u as M}from"./xcs-vue-family-70642f71.js";import{d as J,b as K}from"./xcs-canvas-5c2592d6.js";import{u as Q}from"./use-message-cd8b9f19.js";import"./index-55948043.js";import"./modal-c96d5b67.js";import"./button-00b27872.js";import"./light-87cce264.js";import"./space-5433d955.js";import"./use-style-1280d407.js";import"./loading-b06a4834.js";import"./scrollbar-5a89bf25.js";import"./fade-in.cssr-8e3c8f09.js";import"./image-bad03660.js";import"./spin-afa417d1.js";import"./text-3b674000.js";import"./light-28752129.js";import"./checkbox-9495194d.js";import"./inputnumber-fff11604.js";import"./headers-069f588a.js";const Ce=N({__name:"DeviceSettings",props:{show:{type:Boolean},laserFaq:null,info:null,ext:null,gtmFlameAlarm:{type:Function},gtmLimitSwitch:{type:Function},gtmMoveStop:{type:Function},gtmPositionMode:{type:Function},exportGcode:{type:Function},setExtSettingParams:{type:Function},setDeviceInfo:{type:Function},exportLog:{type:Function},checkUpdateFirmware:{type:Function},setDeviceName:{type:Function},setFillLight:{type:Function},setFlameAlarm:{type:Function},onShowMessage:{type:Function},setOfflineModeEnable:{type:Function}},emits:["close","showWifiConfig","showConnector"],setup(P,{emit:l}){const t=P,{t:e}=R(),f=()=>{l("close")},F=(i,n,a)=>{if(i){t.onShowMessage("info","device.process.device_is_working");return}return n(a)},L=Q(),u=(i,n)=>t.ext.isWifiConnect?{params:{cmd:`${n}${i}`}}:i,g=()=>{const i=t.ext.canvasId,n=t.ext.dataSource.data[i].mode,{current:a}=t.ext.getCurrentArea(n);t.ext.emit($.UPDATE_PROCESSING_AREA,{canvasId:i,option:{...a}})},D=500,k=(i,n)=>{var s;const a=u(`X${i} Y${n}`,"M98");(s=t.ext.apis)==null||s.setRedCrossOffset(a)},v=x(()=>{var i;return((i=t.info)==null?void 0:i.name)||"-"});let p=Y(v.value);const b=J(k,D),I=x(()=>{const{show:i,info:n,laserFaq:a,ext:s}=t,{cover:S,name:w,snCode:W,version:O,power:m,gMode:d,redCrossOffsetX:y,type:z,ip:_,redCrossOffsetY:h,redLight:B,isInProcessing:E}=n,G={vertical:!1,align:"center",justify:"space-between"},A=`${s.isWifiConnect?e("device.setting.wifi_connected"):e("device.setting.wifi_not_connected")} ${_!=="0.0.0.0"?`- ${_}`:""}`,V=B?[{id:"gMode",label:e("device.setting.position_mode"),type:"radioGroup",value:d,attrs:{options:[{label:e("device.setting.red_dot"),value:0}],onUpdateValue:o=>{var r,C;const c=u("S0 N0","M9");t.setDeviceInfo({gMode:o}),t.ext.changeWalkBorderParams(),g(),o?(r=s.apis)==null||r.toLowLightMode():((C=s.apis)==null||C.toRedCrossMode(),s.apis.setLaserPower(c)),t.gtmPositionMode({positionMode:o})}}}]:[{id:"gMode",label:e("device.setting.position_mode"),type:"radioGroup",value:d,attrs:{options:[{label:e("device.setting.red_cross"),value:0},{label:e("device.setting.laser_spot"),value:1}],onUpdateValue:o=>{var c,r;t.setDeviceInfo({gMode:o}),t.ext.changeWalkBorderParams(),g(),o?(c=s.apis)==null||c.toLowLightMode():((r=s.apis)==null||r.toRedCrossMode(),t.setExtSettingParams({isLowLight:!1}),s.setLowLight({isLowLight:!1,lightPower:3})),t.gtmPositionMode({positionMode:o})}}},{id:"redCrossOffset",label:e("device.setting.red_cross_offset"),type:"group",children:[{id:"redCrossOffsetX",type:"number",value:y,attrs:{size:"small",showButton:!1,disabled:d===1,prefix:"X",suffix:"mm",min:-5,max:5,fractionDigits:1,step:.1,onUpdateValue:o=>{t.setDeviceInfo({redCrossOffsetX:o}),b(o,h)}}},{id:"redCrossOffsetY",type:"number",value:h,attrs:{size:"small",showButton:!1,disabled:d===1,prefix:"Y",suffix:"mm",min:-5,max:5,step:.1,fractionDigits:1,onUpdateValue:o=>{t.setDeviceInfo({redCrossOffsetY:o}),b(y,o)}}}]}];return{show:i,close:f,info:{url:S,name:w,button:{label:e("device.setting.change"),id:"changeDevice",action:()=>{f(),l("showConnector")}}},list:[{id:"base",label:e("device.setting.basic"),formData:[{id:"name",label:e("device.setting.name"),type:"input",value:p.value,attrs:{size:"small",maxlength:15,onUpdateValue:o=>{p.value=o},onBlur:o=>{var r;if(K(p.value.trim())){p.value=w,L.error(e("device.setting.name_is_empty"));return}const c=u(`${JSON.stringify(o.target.value)}`,"M100");(r=s.apis)==null||r.setDeviceName(c),t.setDeviceInfo({name:o.target.value})}}},{id:"powerGroup",label:e("device.setting.model"),type:"group",spaceProps:{justify:"space-between"},children:[{id:"power",type:"text",value:m>0?`${m} W`:e("device.setting.unrecognized_laser_model")},{id:"unrecognizedLaser",type:"button",label:e("device.setting.unrecognized_laser_faq"),hidden:m>0,attrs:{class:"unrecognized-laser-button",size:"tiny",tag:"a",text:!0,target:"_blank",href:a}}]},{id:"snCode",label:e("device.setting.serial_num"),type:"text",value:W},{id:"firmwareVersionGroup",label:e("device.setting.firmware_version"),type:"group",spaceProps:{justify:"space-between"},children:[{id:"version",type:"text",value:O},{id:"firmwareVersionButton",type:"button",label:e("device.setting.check_firmware"),attrs:{size:"small",style:{minWidth:"72px"},onClick:t.checkUpdateFirmware}}]},{id:"wifiConfigGroup",label:e("device.connect.wifi_config"),type:"group",spaceProps:{justify:"space-between"},children:[{id:"wifiConnect",type:"text",value:A},{id:"wifiConfigButton",type:"button",hidden:{}.VITE_PAD,label:e("device.connect.wifi_config_button_label"),attrs:{size:"small",style:{minWidth:"72px"},disabled:z==="WIFI",onClick:()=>{l("showWifiConfig")}}}]}]},{id:"workParam",label:e("device.setting.work_param"),formData:[...V,{id:"workLogsGroup",label:e("device.setting.export_gcode"),type:"buttonGroup",attrs:{spaceProps:G,options:[{id:"workLogsButton",type:"button",label:e("device.common.export"),attrs:{size:"small",onClick:()=>{const o=E.value&&!s.isWifiConnect;return F(o,t.exportGcode)}}}]}}]}]}});return T(()=>v.value,i=>{p.value=i}),(i,n)=>(X(),j(M(U),q(H(M(I))),null,16))}});export{Ce as default};
