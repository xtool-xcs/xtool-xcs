import{u as I,j as _,F as w,B as g,_ as k,I as B,a6 as D}from"../assets/index-83a10b2e.js";import{N as E}from"./index-36e5bf24.js";import{k as f,H as T,b as V,o as S,D as v,E as C,j as o,A as $,J as p,y as N,K as P,u as m,F as A,a5 as F,a4 as K}from"./xcs-vue-family-70642f71.js";import{u as R,_ as U}from"./connectconfirm.vue_vue_type_script_setup_true_lang-a878591c.js";import{i as j}from"./xcs-canvas-5c2592d6.js";import"./index-55948043.js";const q={class:"connect-wrap"},z=f({__name:"IpPanel",setup(y){const{t:c}=T(),t=V(""),{showConnectToast:s,successToastAction:r,failToastAction:i,closeConnectToast:u}=R(),e=I(),l=async()=>{const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;if(!t.value){_(c("device.connect.enter_ip_address"));return}if(!n.test(t.value)){_(c("device.connect.ip_input_error_massage"));return}try{s(),await e.loadExtByIP(t.value),console.log("loadExtByIP => connect success"),u(),e.connectConfirmVisible||r()}catch(a){console.log(["connect failed",a]),i()}},d=async n=>{if(!j(n)){if(!e.supportDevices.includes(n.product)){_(c("mobile.toast.device_not_supported"));return}try{s(),e.connectConfirmVisible=!1,await e.loadConnectedExt(n),r()}catch{i()}finally{e.clearConnectConfirmState()}}};return S(()=>{e.clearConnectConfirmState()}),(n,a)=>{const b=w,h=g;return v(),C("div",q,[o(b,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=x=>t.value=x),clearable:"",placeholder:n.$t("device.connect.enter_ip_address"),onKeyup:$(l,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),o(h,{class:"xcs-connect-btn",type:"primary",color:"#00AD21",block:"",onClick:l},{default:p(()=>[N(P(n.$t("component.button.connect")),1)]),_:1}),o(m(U),{confirm:()=>d(m(e).connectDeviceData)},null,8,["confirm"])])}}});const H=k(z,[["__scopeId","data-v-1bfd8dc3"]]),W=f({__name:"IpConnect",setup(y){const c=K(),t=F(),s=()=>t.back(),r=()=>t.push({path:"/new-device",query:c.query});return(i,u)=>{const e=B,l=D,d=E;return v(),C(A,null,[o(d,{"left-arrow":"",title:i.$t("component.button.select_device"),onClickLeft:s},{right:p(()=>[o(l,{size:18},{default:p(()=>[o(e,{name:"add-o",size:"24",onClick:r})]),_:1})]),_:1},8,["title"]),o(H)],64)}}});export{W as default};
